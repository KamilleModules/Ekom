-- MySQL Script generated by MySQL Workbench
-- Mon May 29 06:12:00 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema kamille
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema kamille
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `kamille` DEFAULT CHARACTER SET utf8 ;
USE `kamille` ;

-- -----------------------------------------------------
-- Table `kamille`.`ek_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(64) NOT NULL,
  `iso_code` VARCHAR(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `iso_code_UNIQUE` (`iso_code` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_backoffice_user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_backoffice_user` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `email` VARCHAR(128) NOT NULL,
  `pass` VARCHAR(64) NOT NULL,
  `lang_iso` VARCHAR(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `email_UNIQUE` (`email` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_currency`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_currency` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `iso_code` VARCHAR(3) NOT NULL,
  `symbol` VARCHAR(12) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `iso_code_UNIQUE` (`iso_code` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_timezone`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_timezone` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(64) NOT NULL,
  `host` VARCHAR(128) NOT NULL,
  `lang_id` INT NULL,
  `currency_id` INT NOT NULL,
  `timezone_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_shop_lang1_idx` (`lang_id` ASC),
  INDEX `fk_shop_currency1_idx` (`currency_id` ASC),
  INDEX `fk_shop_timezone1_idx` (`timezone_id` ASC),
  UNIQUE INDEX `host_UNIQUE` (`host` ASC),
  CONSTRAINT `fk_shop_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_shop_currency1`
  FOREIGN KEY (`currency_id`)
  REFERENCES `kamille`.`ek_currency` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_shop_timezone1`
  FOREIGN KEY (`timezone_id`)
  REFERENCES `kamille`.`ek_timezone` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_configuration`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_configuration` (
  `shop_id` INT NOT NULL,
  `key` VARCHAR(64) NOT NULL,
  `value` VARCHAR(256) NOT NULL,
  PRIMARY KEY (`shop_id`),
  UNIQUE INDEX `key_UNIQUE` (`key` ASC),
  CONSTRAINT `fk_shop_configuration_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_store`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_store` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `label_UNIQUE` (`label` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_lang` (
  `shop_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`shop_id`, `lang_id`),
  INDEX `fk_shop_has_lang_lang1_idx` (`lang_id` ASC),
  INDEX `fk_shop_has_lang_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_shop_has_lang_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_shop_has_lang_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_currency`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_currency` (
  `shop_id` INT NOT NULL,
  `currency_id` INT NOT NULL,
  `exchange_rate` DECIMAL(20,6) NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`shop_id`, `currency_id`),
  INDEX `fk_shop_has_currency_currency1_idx` (`currency_id` ASC),
  INDEX `fk_shop_has_currency_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_shop_has_currency_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_shop_has_currency_currency1`
  FOREIGN KEY (`currency_id`)
  REFERENCES `kamille`.`ek_currency` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_store`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_store` (
  `shop_id` INT NOT NULL,
  `store_id` INT NOT NULL,
  PRIMARY KEY (`shop_id`, `store_id`),
  INDEX `fk_shop_has_store_store1_idx` (`store_id` ASC),
  INDEX `fk_shop_has_store_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_shop_has_store_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_shop_has_store_store1`
  FOREIGN KEY (`store_id`)
  REFERENCES `kamille`.`ek_store` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_card`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_card` (
  `id` INT NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `reference` VARCHAR(64) NOT NULL,
  `weight` DECIMAL(20,6) NOT NULL,
  `price` DECIMAL(20,6) NOT NULL,
  `product_card_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `reference_UNIQUE` (`reference` ASC),
  INDEX `fk_ek_product_ek_product_card1_idx` (`product_card_id` ASC),
  CONSTRAINT `fk_ek_product_ek_product_card1`
  FOREIGN KEY (`product_card_id`)
  REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product` (
  `shop_id` INT NOT NULL,
  `product_id` INT NOT NULL,
  `price` DECIMAL(20,6) NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`shop_id`, `product_id`),
  INDEX `fk_shop_has_product_product1_idx` (`product_id` ASC),
  INDEX `fk_shop_has_product_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_shop_has_product_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_shop_has_product_product1`
  FOREIGN KEY (`product_id`)
  REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_store_has_product`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_store_has_product` (
  `store_id` INT NOT NULL,
  `product_id` INT NOT NULL,
  `quantity` INT NOT NULL,
  PRIMARY KEY (`store_id`, `product_id`),
  INDEX `fk_store_has_product_product1_idx` (`product_id` ASC),
  INDEX `fk_store_has_product_store1_idx` (`store_id` ASC),
  CONSTRAINT `fk_store_has_product_store1`
  FOREIGN KEY (`store_id`)
  REFERENCES `kamille`.`ek_store` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_store_has_product_product1`
  FOREIGN KEY (`product_id`)
  REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute_value`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute_value` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `value` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `value_UNIQUE` (`value` ASC))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_has_product_attribute`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_has_product_attribute` (
  `product_id` INT NOT NULL,
  `product_attribute_id` INT NOT NULL,
  `product_attribute_value_id` INT NOT NULL,
  PRIMARY KEY (`product_id`, `product_attribute_id`, `product_attribute_value_id`),
  INDEX `fk_product_has_product_attribute_product_attribute1_idx` (`product_attribute_id` ASC),
  INDEX `fk_product_has_product_attribute_product1_idx` (`product_id` ASC),
  INDEX `fk_product_has_product_attribute_product_attribute_value1_idx` (`product_attribute_value_id` ASC),
  CONSTRAINT `fk_product_has_product_attribute_product1`
  FOREIGN KEY (`product_id`)
  REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_product_has_product_attribute_product_attribute1`
  FOREIGN KEY (`product_attribute_id`)
  REFERENCES `kamille`.`ek_product_attribute` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_product_has_product_attribute_product_attribute_value1`
  FOREIGN KEY (`product_attribute_value_id`)
  REFERENCES `kamille`.`ek_product_attribute_value` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute_value_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute_value_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `value` VARCHAR(64) NOT NULL,
  `product_attribute_value_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_attribute_value_lang_ek_product_attribute_val_idx` (`product_attribute_value_id` ASC),
  INDEX `fk_ek_product_attribute_value_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_product_attribute_value_lang_ek_product_attribute_value1`
  FOREIGN KEY (`product_attribute_value_id`)
  REFERENCES `kamille`.`ek_product_attribute_value` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_attribute_value_lang_ek_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  `product_attribute_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_attribute_lang_ek_product_attribute1_idx` (`product_attribute_id` ASC),
  INDEX `fk_ek_product_attribute_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_product_attribute_lang_ek_product_attribute1`
  FOREIGN KEY (`product_attribute_id`)
  REFERENCES `kamille`.`ek_product_attribute` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_attribute_lang_ek_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_card_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_card_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `product_card_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_lang_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_product_lang_ek_lang2_idx` (`lang_id` ASC),
  UNIQUE INDEX `slug_UNIQUE` (`slug` ASC, `lang_id` ASC),
  CONSTRAINT `fk_ek_product_lang_ek_product_card1`
  FOREIGN KEY (`product_card_id`)
  REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_lang_ek_lang2`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  `product_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_lang_ek_product1_idx` (`product_id` ASC),
  INDEX `fk_ek_product_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_product_lang_ek_product1`
  FOREIGN KEY (`product_id`)
  REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_lang_ek_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `shop_id` INT NOT NULL,
  `product_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_shop_has_product_lang_ek_shop_has_product1_idx` (`shop_id` ASC, `product_id` ASC),
  INDEX `fk_ek_shop_has_product_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_shop_has_product_lang_ek_shop_has_product1`
  FOREIGN KEY (`shop_id` , `product_id`)
  REFERENCES `kamille`.`ek_shop_has_product` (`shop_id` , `product_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_product_lang_ek_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_category`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_category` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  `category_id` INT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC, `shop_id` ASC),
  INDEX `fk_category_category1_idx` (`category_id` ASC),
  INDEX `fk_ek_category_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_category_category1`
  FOREIGN KEY (`category_id`)
  REFERENCES `kamille`.`ek_category` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_category_ek_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_category_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_category_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(64) NOT NULL,
  `description` TEXT NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `category_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_category_lang_category1_idx` (`category_id` ASC),
  INDEX `fk_category_lang_ek_lang1_idx` (`lang_id` ASC),
  UNIQUE INDEX `slug_UNIQUE` (`slug` ASC, `category_id` ASC, `lang_id` ASC),
  CONSTRAINT `fk_category_lang_category1`
  FOREIGN KEY (`category_id`)
  REFERENCES `kamille`.`ek_category` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_category_lang_ek_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_category_has_product_card`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_category_has_product_card` (
  `category_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  PRIMARY KEY (`category_id`, `product_card_id`),
  INDEX `fk_ek_category_has_ek_product_card_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_category_has_ek_product_card_ek_category1_idx` (`category_id` ASC),
  CONSTRAINT `fk_ek_category_has_ek_product_card_ek_category1`
  FOREIGN KEY (`category_id`)
  REFERENCES `kamille`.`ek_category` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_category_has_ek_product_card_ek_product_card1`
  FOREIGN KEY (`product_card_id`)
  REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product_card`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product_card` (
  `shop_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  `product_id` INT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`shop_id`, `product_card_id`),
  INDEX `fk_ek_shop_has_ek_product_card_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_shop_has_ek_product_card_ek_shop1_idx` (`shop_id` ASC),
  INDEX `fk_ek_shop_has_product_card_ek_product1_idx` (`product_id` ASC),
  CONSTRAINT `fk_ek_shop_has_ek_product_card_ek_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_ek_product_card_ek_product_card1`
  FOREIGN KEY (`product_card_id`)
  REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_product_card_ek_product1`
  FOREIGN KEY (`product_id`)
  REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product_card_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product_card_lang` (
  `shop_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  INDEX `fk_ek_shop_has_product_card_lang_ek_shop_has_product_card1_idx` (`shop_id` ASC, `product_card_id` ASC),
  INDEX `fk_ek_shop_has_product_card_lang_ek_lang1_idx` (`lang_id` ASC),
  PRIMARY KEY (`shop_id`, `product_card_id`, `lang_id`),
  CONSTRAINT `fk_ek_shop_has_product_card_lang_ek_shop_has_product_card1`
  FOREIGN KEY (`shop_id` , `product_card_id`)
  REFERENCES `kamille`.`ek_shop_has_product_card` (`shop_id` , `product_card_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_product_card_lang_ek_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `amount` DECIMAL(10,6) NOT NULL,
  PRIMARY KEY (`id`))
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax_lang` (
  `tax_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  PRIMARY KEY (`tax_id`, `lang_id`),
  INDEX `fk_tax_has_ek_lang_ek_lang1_idx` (`lang_id` ASC),
  INDEX `fk_tax_has_ek_lang_tax1_idx` (`tax_id` ASC),
  CONSTRAINT `fk_tax_has_ek_lang_tax1`
  FOREIGN KEY (`tax_id`)
  REFERENCES `kamille`.`ek_tax` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_tax_has_ek_lang_ek_lang1`
  FOREIGN KEY (`lang_id`)
  REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax_group`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax_group` (
  `id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  `condition` TEXT NOT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_tax_group_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_tax_group_ek_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax_group_has_tax`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax_group_has_tax` (
  `tax_group_id` INT NOT NULL,
  `tax_id` INT NOT NULL,
  `order` TINYINT NOT NULL,
  `mode` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`tax_group_id`, `tax_id`),
  INDEX `fk_tax_group_has_tax_tax1_idx` (`tax_id` ASC),
  INDEX `fk_tax_group_has_tax_tax_group1_idx` (`tax_group_id` ASC),
  CONSTRAINT `fk_tax_group_has_tax_tax_group1`
  FOREIGN KEY (`tax_group_id`)
  REFERENCES `kamille`.`ek_tax_group` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_tax_group_has_tax_tax1`
  FOREIGN KEY (`tax_id`)
  REFERENCES `kamille`.`ek_tax` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_card_has_tax_group`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_card_has_tax_group` (
  `shop_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  `tax_group_id` INT NOT NULL,
  PRIMARY KEY (`shop_id`, `product_card_id`),
  INDEX `fk_ek_product_card_has_ek_tax_group_ek_tax_group1_idx` (`tax_group_id` ASC),
  INDEX `fk_ek_product_card_has_ek_tax_group_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_product_card_has_tax_group_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_product_card_has_ek_tax_group_ek_product_card1`
  FOREIGN KEY (`product_card_id`)
  REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_card_has_ek_tax_group_ek_tax_group1`
  FOREIGN KEY (`tax_group_id`)
  REFERENCES `kamille`.`ek_tax_group` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_card_has_tax_group_ek_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_user` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `shop_id` INT NOT NULL,
  `email` VARCHAR(128) NOT NULL,
  `pass` VARCHAR(255) NOT NULL,
  `date_creation` DATETIME NOT NULL,
  `mobile` VARCHAR(24) NOT NULL,
  `phone` VARCHAR(24) NOT NULL,
  `newsletter` TINYINT(1) NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_user_ek_shop1_idx` (`shop_id` ASC),
  UNIQUE INDEX `email_UNIQUE` (`email` ASC, `shop_id` ASC),
  CONSTRAINT `fk_user_ek_shop1`
  FOREIGN KEY (`shop_id`)
  REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
  ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
