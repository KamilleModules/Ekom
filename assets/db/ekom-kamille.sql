-- MySQL Script generated by MySQL Workbench
-- Sun Jun  4 14:16:34 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema kamille
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema kamille
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `kamille` DEFAULT CHARACTER SET utf8 ;
USE `kamille` ;

-- -----------------------------------------------------
-- Table `kamille`.`ek_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(64) NOT NULL,
  `iso_code` VARCHAR(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `iso_code_UNIQUE` (`iso_code` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_backoffice_user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_backoffice_user` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `email` VARCHAR(128) NOT NULL,
  `pass` VARCHAR(64) NOT NULL,
  `lang_iso` VARCHAR(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `email_UNIQUE` (`email` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_currency`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_currency` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `iso_code` VARCHAR(3) NOT NULL,
  `symbol` VARCHAR(12) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `iso_code_UNIQUE` (`iso_code` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_timezone`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_timezone` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(64) NOT NULL,
  `host` VARCHAR(128) NOT NULL,
  `lang_id` INT NULL,
  `currency_id` INT NOT NULL,
  `timezone_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_shop_lang1_idx` (`lang_id` ASC),
  INDEX `fk_shop_currency1_idx` (`currency_id` ASC),
  INDEX `fk_shop_timezone1_idx` (`timezone_id` ASC),
  UNIQUE INDEX `host_UNIQUE` (`host` ASC),
  CONSTRAINT `fk_shop_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_shop_currency1`
    FOREIGN KEY (`currency_id`)
    REFERENCES `kamille`.`ek_currency` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_shop_timezone1`
    FOREIGN KEY (`timezone_id`)
    REFERENCES `kamille`.`ek_timezone` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_configuration`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_configuration` (
  `shop_id` INT NOT NULL,
  `key` VARCHAR(64) NOT NULL,
  `value` VARCHAR(256) NOT NULL,
  PRIMARY KEY (`shop_id`),
  UNIQUE INDEX `key_UNIQUE` (`key` ASC),
  CONSTRAINT `fk_shop_configuration_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_lang` (
  `shop_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`shop_id`, `lang_id`),
  INDEX `fk_shop_has_lang_lang1_idx` (`lang_id` ASC),
  INDEX `fk_shop_has_lang_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_shop_has_lang_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_shop_has_lang_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_currency`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_currency` (
  `shop_id` INT NOT NULL,
  `currency_id` INT NOT NULL,
  `exchange_rate` DECIMAL(20,6) NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`shop_id`, `currency_id`),
  INDEX `fk_shop_has_currency_currency1_idx` (`currency_id` ASC),
  INDEX `fk_shop_has_currency_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_shop_has_currency_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_shop_has_currency_currency1`
    FOREIGN KEY (`currency_id`)
    REFERENCES `kamille`.`ek_currency` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_card`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_card` (
  `id` INT NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `reference` VARCHAR(64) NOT NULL,
  `weight` DECIMAL(20,6) NOT NULL,
  `price` DECIMAL(20,2) NOT NULL,
  `product_card_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `reference_UNIQUE` (`reference` ASC),
  INDEX `fk_ek_product_ek_product_card1_idx` (`product_card_id` ASC),
  CONSTRAINT `fk_ek_product_ek_product_card1`
    FOREIGN KEY (`product_card_id`)
    REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product` (
  `shop_id` INT NOT NULL,
  `product_id` INT NOT NULL,
  `price` DECIMAL(20,2) NULL,
  `wholesale_price` DECIMAL(20,2) NOT NULL,
  `quantity` INT NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`shop_id`, `product_id`),
  INDEX `fk_shop_has_product_product1_idx` (`product_id` ASC),
  INDEX `fk_shop_has_product_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_shop_has_product_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_shop_has_product_product1`
    FOREIGN KEY (`product_id`)
    REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute_value`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute_value` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `value` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `value_UNIQUE` (`value` ASC))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_has_product_attribute`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_has_product_attribute` (
  `product_id` INT NOT NULL,
  `product_attribute_id` INT NOT NULL,
  `product_attribute_value_id` INT NOT NULL,
  PRIMARY KEY (`product_id`, `product_attribute_id`, `product_attribute_value_id`),
  INDEX `fk_product_has_product_attribute_product_attribute1_idx` (`product_attribute_id` ASC),
  INDEX `fk_product_has_product_attribute_product1_idx` (`product_id` ASC),
  INDEX `fk_product_has_product_attribute_product_attribute_value1_idx` (`product_attribute_value_id` ASC),
  CONSTRAINT `fk_product_has_product_attribute_product1`
    FOREIGN KEY (`product_id`)
    REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_product_has_product_attribute_product_attribute1`
    FOREIGN KEY (`product_attribute_id`)
    REFERENCES `kamille`.`ek_product_attribute` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_product_has_product_attribute_product_attribute_value1`
    FOREIGN KEY (`product_attribute_value_id`)
    REFERENCES `kamille`.`ek_product_attribute_value` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute_value_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute_value_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `value` VARCHAR(64) NOT NULL,
  `product_attribute_value_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_attribute_value_lang_ek_product_attribute_val_idx` (`product_attribute_value_id` ASC),
  INDEX `fk_ek_product_attribute_value_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_product_attribute_value_lang_ek_product_attribute_value1`
    FOREIGN KEY (`product_attribute_value_id`)
    REFERENCES `kamille`.`ek_product_attribute_value` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_attribute_value_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_attribute_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_attribute_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  `product_attribute_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_attribute_lang_ek_product_attribute1_idx` (`product_attribute_id` ASC),
  INDEX `fk_ek_product_attribute_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_product_attribute_lang_ek_product_attribute1`
    FOREIGN KEY (`product_attribute_id`)
    REFERENCES `kamille`.`ek_product_attribute` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_attribute_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_card_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_card_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `product_card_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_lang_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_product_lang_ek_lang2_idx` (`lang_id` ASC),
  UNIQUE INDEX `slug_UNIQUE` (`slug` ASC, `lang_id` ASC),
  CONSTRAINT `fk_ek_product_lang_ek_product_card1`
    FOREIGN KEY (`product_card_id`)
    REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_lang_ek_lang2`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  `product_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_product_lang_ek_product1_idx` (`product_id` ASC),
  INDEX `fk_ek_product_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_product_lang_ek_product1`
    FOREIGN KEY (`product_id`)
    REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `out_of_stock_text` VARCHAR(128) NOT NULL,
  `shop_id` INT NOT NULL,
  `product_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_shop_has_product_lang_ek_shop_has_product1_idx` (`shop_id` ASC, `product_id` ASC),
  INDEX `fk_ek_shop_has_product_lang_ek_lang1_idx` (`lang_id` ASC),
  CONSTRAINT `fk_ek_shop_has_product_lang_ek_shop_has_product1`
    FOREIGN KEY (`shop_id` , `product_id`)
    REFERENCES `kamille`.`ek_shop_has_product` (`shop_id` , `product_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_product_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_category`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_category` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  `category_id` INT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC, `shop_id` ASC),
  INDEX `fk_category_category1_idx` (`category_id` ASC),
  INDEX `fk_ek_category_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_category_category1`
    FOREIGN KEY (`category_id`)
    REFERENCES `kamille`.`ek_category` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_category_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_category_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_category_lang` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `label` VARCHAR(64) NOT NULL,
  `description` TEXT NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `category_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_category_lang_category1_idx` (`category_id` ASC),
  INDEX `fk_category_lang_ek_lang1_idx` (`lang_id` ASC),
  UNIQUE INDEX `slug_UNIQUE` (`slug` ASC, `category_id` ASC, `lang_id` ASC),
  CONSTRAINT `fk_category_lang_category1`
    FOREIGN KEY (`category_id`)
    REFERENCES `kamille`.`ek_category` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_category_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_category_has_product_card`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_category_has_product_card` (
  `category_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  PRIMARY KEY (`category_id`, `product_card_id`),
  INDEX `fk_ek_category_has_ek_product_card_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_category_has_ek_product_card_ek_category1_idx` (`category_id` ASC),
  CONSTRAINT `fk_ek_category_has_ek_product_card_ek_category1`
    FOREIGN KEY (`category_id`)
    REFERENCES `kamille`.`ek_category` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_category_has_ek_product_card_ek_product_card1`
    FOREIGN KEY (`product_card_id`)
    REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product_card`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product_card` (
  `shop_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  `product_id` INT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`shop_id`, `product_card_id`),
  INDEX `fk_ek_shop_has_ek_product_card_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_shop_has_ek_product_card_ek_shop1_idx` (`shop_id` ASC),
  INDEX `fk_ek_shop_has_product_card_ek_product1_idx` (`product_id` ASC),
  CONSTRAINT `fk_ek_shop_has_ek_product_card_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_ek_product_card_ek_product_card1`
    FOREIGN KEY (`product_card_id`)
    REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_product_card_ek_product1`
    FOREIGN KEY (`product_id`)
    REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_product_card_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_product_card_lang` (
  `shop_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  `slug` VARCHAR(128) NOT NULL,
  `description` TEXT NOT NULL,
  INDEX `fk_ek_shop_has_product_card_lang_ek_shop_has_product_card1_idx` (`shop_id` ASC, `product_card_id` ASC),
  INDEX `fk_ek_shop_has_product_card_lang_ek_lang1_idx` (`lang_id` ASC),
  PRIMARY KEY (`shop_id`, `product_card_id`, `lang_id`),
  CONSTRAINT `fk_ek_shop_has_product_card_lang_ek_shop_has_product_card1`
    FOREIGN KEY (`shop_id` , `product_card_id`)
    REFERENCES `kamille`.`ek_shop_has_product_card` (`shop_id` , `product_card_id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_product_card_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `amount` DECIMAL(10,6) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax_lang` (
  `tax_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  PRIMARY KEY (`tax_id`, `lang_id`),
  INDEX `fk_tax_has_ek_lang_ek_lang1_idx` (`lang_id` ASC),
  INDEX `fk_tax_has_ek_lang_tax1_idx` (`tax_id` ASC),
  CONSTRAINT `fk_tax_has_ek_lang_tax1`
    FOREIGN KEY (`tax_id`)
    REFERENCES `kamille`.`ek_tax` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_tax_has_ek_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax_group`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax_group` (
  `id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  `condition` TEXT NOT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_tax_group_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_tax_group_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_tax_group_has_tax`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_tax_group_has_tax` (
  `tax_group_id` INT NOT NULL,
  `tax_id` INT NOT NULL,
  `order` TINYINT NOT NULL,
  `mode` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`tax_group_id`, `tax_id`),
  INDEX `fk_tax_group_has_tax_tax1_idx` (`tax_id` ASC),
  INDEX `fk_tax_group_has_tax_tax_group1_idx` (`tax_group_id` ASC),
  CONSTRAINT `fk_tax_group_has_tax_tax_group1`
    FOREIGN KEY (`tax_group_id`)
    REFERENCES `kamille`.`ek_tax_group` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_tax_group_has_tax_tax1`
    FOREIGN KEY (`tax_id`)
    REFERENCES `kamille`.`ek_tax` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_card_has_tax_group`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_card_has_tax_group` (
  `shop_id` INT NOT NULL,
  `product_card_id` INT NOT NULL,
  `tax_group_id` INT NOT NULL,
  PRIMARY KEY (`shop_id`, `product_card_id`),
  INDEX `fk_ek_product_card_has_ek_tax_group_ek_tax_group1_idx` (`tax_group_id` ASC),
  INDEX `fk_ek_product_card_has_ek_tax_group_ek_product_card1_idx` (`product_card_id` ASC),
  INDEX `fk_ek_product_card_has_tax_group_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_product_card_has_ek_tax_group_ek_product_card1`
    FOREIGN KEY (`product_card_id`)
    REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_card_has_ek_tax_group_ek_tax_group1`
    FOREIGN KEY (`tax_group_id`)
    REFERENCES `kamille`.`ek_tax_group` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_card_has_tax_group_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_user`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_user` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `shop_id` INT NOT NULL,
  `email` VARCHAR(128) NOT NULL,
  `pass` VARCHAR(255) NOT NULL,
  `date_creation` DATETIME NOT NULL,
  `mobile` VARCHAR(24) NOT NULL,
  `phone` VARCHAR(24) NOT NULL,
  `newsletter` TINYINT(1) NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_user_ek_shop1_idx` (`shop_id` ASC),
  UNIQUE INDEX `email_UNIQUE` (`email` ASC, `shop_id` ASC),
  CONSTRAINT `fk_user_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_user_group`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_user_group` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `name_UNIQUE` (`name` ASC),
  INDEX `fk_ek_user_group_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_user_group_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_discount`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_discount` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `user_group_id` INT NULL,
  `currency_id` INT NULL,
  `date_start` DATETIME NULL,
  `date_end` DATETIME NULL,
  `procedure_type` VARCHAR(64) NOT NULL,
  `procedure_operand` VARCHAR(64) NOT NULL,
  `target` VARCHAR(64) NOT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_discount_ek_user_group1_idx` (`user_group_id` ASC),
  INDEX `fk_discount_ek_currency1_idx` (`currency_id` ASC),
  INDEX `fk_discount_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_discount_ek_user_group1`
    FOREIGN KEY (`user_group_id`)
    REFERENCES `kamille`.`ek_user_group` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_discount_ek_currency1`
    FOREIGN KEY (`currency_id`)
    REFERENCES `kamille`.`ek_currency` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_discount_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_user_has_user_group`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_user_has_user_group` (
  `user_id` INT NOT NULL,
  `user_group_id` INT NOT NULL,
  PRIMARY KEY (`user_id`, `user_group_id`),
  INDEX `fk_ek_user_has_ek_user_group_ek_user_group1_idx` (`user_group_id` ASC),
  INDEX `fk_ek_user_has_ek_user_group_ek_user1_idx` (`user_id` ASC),
  CONSTRAINT `fk_ek_user_has_ek_user_group_ek_user1`
    FOREIGN KEY (`user_id`)
    REFERENCES `kamille`.`ek_user` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_user_has_ek_user_group_ek_user_group1`
    FOREIGN KEY (`user_group_id`)
    REFERENCES `kamille`.`ek_user_group` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_discount_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_discount_lang` (
  `discount_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(256) NOT NULL,
  PRIMARY KEY (`discount_id`, `lang_id`),
  INDEX `fk_ek_discount_has_ek_lang_ek_lang1_idx` (`lang_id` ASC),
  INDEX `fk_ek_discount_has_ek_lang_ek_discount1_idx` (`discount_id` ASC),
  CONSTRAINT `fk_ek_discount_has_ek_lang_ek_discount1`
    FOREIGN KEY (`discount_id`)
    REFERENCES `kamille`.`ek_discount` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_discount_has_ek_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_has_discount`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_has_discount` (
  `product_id` INT NOT NULL,
  `discount_id` INT NOT NULL,
  `order_phase` INT NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`product_id`, `discount_id`),
  INDEX `fk_ek_product_has_ek_discount_ek_discount1_idx` (`discount_id` ASC),
  INDEX `fk_ek_product_has_ek_discount_ek_product1_idx` (`product_id` ASC),
  CONSTRAINT `fk_ek_product_has_ek_discount_ek_product1`
    FOREIGN KEY (`product_id`)
    REFERENCES `kamille`.`ek_product` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_has_ek_discount_ek_discount1`
    FOREIGN KEY (`discount_id`)
    REFERENCES `kamille`.`ek_discount` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_product_card_has_discount`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_product_card_has_discount` (
  `product_card_id` INT NOT NULL,
  `discount_id` INT NOT NULL,
  `order_phase` INT NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`product_card_id`, `discount_id`),
  INDEX `fk_ek_product_card_has_ek_discount_ek_discount1_idx` (`discount_id` ASC),
  INDEX `fk_ek_product_card_has_ek_discount_ek_product_card1_idx` (`product_card_id` ASC),
  CONSTRAINT `fk_ek_product_card_has_ek_discount_ek_product_card1`
    FOREIGN KEY (`product_card_id`)
    REFERENCES `kamille`.`ek_product_card` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_product_card_has_ek_discount_ek_discount1`
    FOREIGN KEY (`discount_id`)
    REFERENCES `kamille`.`ek_discount` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_category_has_discount`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_category_has_discount` (
  `category_id` INT NOT NULL,
  `discount_id` INT NOT NULL,
  `order_phase` INT NOT NULL,
  `active` TINYINT(1) NOT NULL,
  PRIMARY KEY (`category_id`, `discount_id`),
  INDEX `fk_ek_category_has_ek_discount_ek_discount1_idx` (`discount_id` ASC),
  INDEX `fk_ek_category_has_ek_discount_ek_category1_idx` (`category_id` ASC),
  CONSTRAINT `fk_ek_category_has_ek_discount_ek_category1`
    FOREIGN KEY (`category_id`)
    REFERENCES `kamille`.`ek_category` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_category_has_ek_discount_ek_discount1`
    FOREIGN KEY (`discount_id`)
    REFERENCES `kamille`.`ek_discount` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_order`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_order` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `user_id` INT NOT NULL,
  `reference` VARCHAR(64) NOT NULL,
  `date` DATETIME NOT NULL,
  `tracking_number` VARCHAR(64) NOT NULL,
  `user_info` TEXT NOT NULL,
  `shop_info` TEXT NOT NULL,
  `invoice_address` TEXT NOT NULL,
  `billing_address` TEXT NOT NULL,
  `order_details` TEXT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_order_ek_user1_idx` (`user_id` ASC),
  UNIQUE INDEX `reference_UNIQUE` (`reference` ASC),
  CONSTRAINT `fk_ek_order_ek_user1`
    FOREIGN KEY (`user_id`)
    REFERENCES `kamille`.`ek_user` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_order_status`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_order_status` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `code` VARCHAR(64) NOT NULL,
  `color` VARCHAR(32) NOT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_order_status_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_order_status_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_order_status_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_order_status_lang` (
  `order_status_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(64) NOT NULL,
  INDEX `fk_ek_order_status_lang_ek_order_status1_idx` (`order_status_id` ASC),
  INDEX `fk_ek_order_status_lang_ek_lang1_idx` (`lang_id` ASC),
  PRIMARY KEY (`order_status_id`, `lang_id`),
  CONSTRAINT `fk_ek_order_status_lang_ek_order_status1`
    FOREIGN KEY (`order_status_id`)
    REFERENCES `kamille`.`ek_order_status` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_order_status_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_order_has_order_status`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_order_has_order_status` (
  `order_id` INT NOT NULL,
  `order_status_id` INT NOT NULL,
  `date` DATETIME NOT NULL,
  PRIMARY KEY (`order_id`, `order_status_id`),
  INDEX `fk_ek_order_has_ek_order_status_ek_order_status1_idx` (`order_status_id` ASC),
  INDEX `fk_ek_order_has_ek_order_status_ek_order1_idx` (`order_id` ASC),
  CONSTRAINT `fk_ek_order_has_ek_order_status_ek_order1`
    FOREIGN KEY (`order_id`)
    REFERENCES `kamille`.`ek_order` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_order_has_ek_order_status_ek_order_status1`
    FOREIGN KEY (`order_status_id`)
    REFERENCES `kamille`.`ek_order_status` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_coupon`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_coupon` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `code` VARCHAR(64) NOT NULL,
  `active` TINYINT(1) NOT NULL,
  `mode` VARCHAR(64) NOT NULL,
  `priority` INT NOT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_coupon_ek_shop1_idx` (`shop_id` ASC),
  UNIQUE INDEX `code_UNIQUE` (`code` ASC, `shop_id` ASC),
  CONSTRAINT `fk_ek_coupon_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_cart_discount`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_cart_discount` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `target` VARCHAR(64) NOT NULL,
  `procedure_type` VARCHAR(64) NOT NULL,
  `procedure_operand` VARCHAR(64) NOT NULL,
  `shop_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_cart_discount_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_cart_discount_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_cart_discount_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_cart_discount_lang` (
  `cart_discount_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  INDEX `fk_ek_cart_discount_lang_ek_cart_discount1_idx` (`cart_discount_id` ASC),
  INDEX `fk_ek_cart_discount_lang_ek_lang1_idx` (`lang_id` ASC),
  PRIMARY KEY (`cart_discount_id`, `lang_id`),
  CONSTRAINT `fk_ek_cart_discount_lang_ek_cart_discount1`
    FOREIGN KEY (`cart_discount_id`)
    REFERENCES `kamille`.`ek_cart_discount` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_cart_discount_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_coupon_has_cart_discount`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_coupon_has_cart_discount` (
  `coupon_id` INT NOT NULL,
  `cart_discount_id` INT NOT NULL,
  PRIMARY KEY (`coupon_id`, `cart_discount_id`),
  INDEX `fk_ek_coupon_has_ek_cart_discount_ek_cart_discount1_idx` (`cart_discount_id` ASC),
  INDEX `fk_ek_coupon_has_ek_cart_discount_ek_coupon1_idx` (`coupon_id` ASC),
  CONSTRAINT `fk_ek_coupon_has_ek_cart_discount_ek_coupon1`
    FOREIGN KEY (`coupon_id`)
    REFERENCES `kamille`.`ek_coupon` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_coupon_has_ek_cart_discount_ek_cart_discount1`
    FOREIGN KEY (`cart_discount_id`)
    REFERENCES `kamille`.`ek_cart_discount` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_coupon_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_coupon_lang` (
  `coupon_id` INT NOT NULL,
  `lang_id` INT NOT NULL COMMENT '	',
  `label` VARCHAR(256) NOT NULL,
  INDEX `fk_ek_coupon_lang_ek_coupon1_idx` (`coupon_id` ASC),
  PRIMARY KEY (`lang_id`, `coupon_id`),
  CONSTRAINT `fk_ek_coupon_lang_ek_coupon1`
    FOREIGN KEY (`coupon_id`)
    REFERENCES `kamille`.`ek_coupon` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_coupon_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_country`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_country` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `iso_code` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_address`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_address` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `city` VARCHAR(128) NOT NULL,
  `postcode` VARCHAR(64) NOT NULL,
  `address` VARCHAR(256) NOT NULL,
  `active` TINYINT(1) NOT NULL,
  `country_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_ek_address_ek_country1_idx` (`country_id` ASC),
  CONSTRAINT `fk_ek_address_ek_country1`
    FOREIGN KEY (`country_id`)
    REFERENCES `kamille`.`ek_country` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_country_lang`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_country_lang` (
  `country_id` INT NOT NULL,
  `lang_id` INT NOT NULL,
  `label` VARCHAR(128) NOT NULL,
  PRIMARY KEY (`country_id`, `lang_id`),
  INDEX `fk_ek_country_has_ek_lang_ek_lang1_idx` (`lang_id` ASC),
  INDEX `fk_ek_country_has_ek_lang_ek_country1_idx` (`country_id` ASC),
  CONSTRAINT `fk_ek_country_has_ek_lang_ek_country1`
    FOREIGN KEY (`country_id`)
    REFERENCES `kamille`.`ek_country` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_country_has_ek_lang_ek_lang1`
    FOREIGN KEY (`lang_id`)
    REFERENCES `kamille`.`ek_lang` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_user_has_address`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_user_has_address` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `user_id` INT NOT NULL,
  `address_id` INT NOT NULL,
  `type` VARCHAR(12) NOT NULL,
  `order` TINYINT(1) NOT NULL,
  INDEX `fk_ek_user_has_ek_address_ek_address1_idx` (`address_id` ASC),
  INDEX `fk_ek_user_has_ek_address_ek_user1_idx` (`user_id` ASC),
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_ek_user_has_ek_address_ek_user1`
    FOREIGN KEY (`user_id`)
    REFERENCES `kamille`.`ek_user` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_user_has_ek_address_ek_address1`
    FOREIGN KEY (`address_id`)
    REFERENCES `kamille`.`ek_address` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_carrier`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_carrier` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(64) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `kamille`.`ek_shop_has_carrier`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `kamille`.`ek_shop_has_carrier` (
  `shop_id` INT NOT NULL,
  `carrier_id` INT NOT NULL,
  `priority` TINYINT(1) NOT NULL,
  PRIMARY KEY (`shop_id`, `carrier_id`),
  INDEX `fk_ek_shop_has_ek_carrier_ek_carrier1_idx` (`carrier_id` ASC),
  INDEX `fk_ek_shop_has_ek_carrier_ek_shop1_idx` (`shop_id` ASC),
  CONSTRAINT `fk_ek_shop_has_ek_carrier_ek_shop1`
    FOREIGN KEY (`shop_id`)
    REFERENCES `kamille`.`ek_shop` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE,
  CONSTRAINT `fk_ek_shop_has_ek_carrier_ek_carrier1`
    FOREIGN KEY (`carrier_id`)
    REFERENCES `kamille`.`ek_carrier` (`id`)
    ON DELETE CASCADE
    ON UPDATE CASCADE)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
